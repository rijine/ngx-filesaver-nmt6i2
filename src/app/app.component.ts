import { Component, OnInit } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { FileSaverService } from 'ngx-filesaver';

@Component({
  selector: 'my-app',
  templateUrl: './app.component.html',
  styleUrls: [ './app.component.css' ]
})
export class AppComponent implements OnInit {
  public text = `{ "text": "This is text file!中文" }`;
  public fileName: string;

  constructor(
    private _httpClient: HttpClient,
    private _FileSaverService: FileSaverService,
  ) {}

  ngOnInit() {}

  onDown(type: string, fromRemote: boolean) {
    const fileName = `save.${type}`;
    if (fromRemote) {
      this._httpClient.get(`assets/files/demo.${type}`, {
        observe: 'response',
        responseType: 'blob'
      }).subscribe(res => {
        const d = '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';
        console.log(res);
        this._FileSaverService.save(res.body, fileName);
      });
      return;
    }
    const fileType = this._FileSaverService.genType(fileName);
    const txtBlob = new Blob([this.text], { type: fileType });
    this._FileSaverService.save(txtBlob, fileName);
  }
}

